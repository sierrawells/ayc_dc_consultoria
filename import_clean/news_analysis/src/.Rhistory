news_w_lemmas <- read_csv(paths$news_w_lemmas) %>%
rename(id_nota = 1)
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_URL), "amlo"),
searchword_morena = str_detect(tolower(search_URL), "morena"),
searchword_sheinbaum = str_detect(tolower(search_URL), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_URL), "gobierno") &
str_detect(tolower(search_URL), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_URL), "defensores") &
str_detect(tolower(search_URL), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]"))) %>%
select(id_nota, title_lemmas, description_lemmas) %>%
separate_rows(title_lemmas, sep = ", ")
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]"))) %>%
select(id_nota, title_lemmas, description_lemmas) %>%
separate_rows(title_lemmas, sep = ", ")
View(lemmas_count)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, lemmas) %>%
separate_rows(lemmas, sep = ", ")
View(lemmas_count)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ")
View(lemmas_count)
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ")
View(lemmas_count)
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ")
View(lemmas_count)
source("~/git/ayc_soc_civil/descriptives/src/descrip_usaid.R", echo=TRUE)
View(lemmas_count)
View(news_w_lemmas)
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ")
# Files
paths <- list(
news_w_lemmas =  here("eda/news_analysis/output/google_news_scraped_lemmatized.csv"),
output = here("eda/news_analysis/output/"))
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ")
View(lemmas_count)
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
# READ DATA ====
news_w_lemmas <- read_csv(paths$news_w_lemmas)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ")
View(lemmas_count)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
lemmas = paste0(title_lemmas, ", ", description_lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas_test =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensores", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
View(lemmas_count)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor", "defensor(a)", lemmas))) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas_test =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor", "defensor(a)"), lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas_test =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor(a)", lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas_test =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
View(lemmas_count)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor", lemmas)) %>%
select(id_nota, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas_test =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
View(lemmas_count)
rm(lemmas_count)
# MOST COMMON LEMMAS ====
lemmas_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor", lemmas)) %>%
select(id_nota, date, search_url, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
View(lemmas_count)
rm(lemmas_count)
# PREPARE LEMMAS FOR COUNT ====
lemmas_for_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor", lemmas)) %>%
select(id_nota, date, search_url, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas))
# MOST COMMON LEMMAS ====
lemmas_count <- lemmas_for_count %>%
count()
# MOST COMMON LEMMAS ====
lemmas_count <- lemmas_for_count %>%
group_by(lemmas)
# MOST COMMON LEMMAS ====
lemmas_count <- lemmas_for_count %>%
group_by(lemmas) %>%
count()
View(lemmas_count)
# PREPARE LEMMAS FOR COUNT ====
lemmas_for_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor", lemmas)) %>%
select(id_nota, date, search_url, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
TRUE ~ lemmas)) %>%
filter(!is.na(lemmas))
# MOST COMMON LEMMAS ====
lemmas_count <- lemmas_for_count %>%
group_by(lemmas) %>%
count()
View(lemmas_count)
# PREPARE LEMMAS FOR COUNT ====
lemmas_to_exclude <- c(
"méxico",
"osc",
"ong",
"civil",
"sociedad"
)
lemmas_for_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor", lemmas)) %>%
select(id_nota, date, search_url, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
lemmas %in% lemmas_to_exclude ~ NA_character_,
TRUE ~ lemmas)) %>%
filter(!is.na(lemmas))
# MOST COMMON LEMMAS ====
lemmas_count <- lemmas_for_count %>%
group_by(lemmas) %>%
count()
View(lemmas_count)
# PREPARE LEMMAS FOR COUNT ====
lemmas_to_exclude <- c(
"méxico",
"osc",
"ong",
"ongs",
"civil",
"sociedad",
"mil"
)
lemmas_for_count <- news_w_lemmas %>%
# Indicate search words (to exclude from lemmas list)
mutate(
searchword_amlo = str_detect(tolower(search_url), "amlo"),
searchword_morena = str_detect(tolower(search_url), "morena"),
searchword_sheinbaum = str_detect(tolower(search_url), "sheinbaum"),
searchword_gobierno_colectivos = str_detect(tolower(search_url), "gobierno") &
str_detect(tolower(search_url), "colectivos"),
searchword_defensores_territorio = str_detect(tolower(search_url), "defensores") &
str_detect(tolower(search_url), "territorio"),
# Clean lemmas
across(contains("lemmas"), ~str_remove_all(.x, "['\\[\\]]")),
# Create single lemmas column
lemmas = paste0(title_lemmas, ", ", description_lemmas),
# Standardize "defensor" lemmas
lemmas = ifelse(str_detect(lemmas, "defensor"), "defensor", lemmas)) %>%
select(id_nota, date, search_url, starts_with("searchword_"), lemmas) %>%
separate_rows(lemmas, sep = ", ") %>%
mutate(
# Replace search words in lemmas with NA
lemmas =
case_when(
(searchword_amlo == TRUE & lemmas == "amlo") ~ NA_character_,
(searchword_morena == TRUE & lemmas == "morena") ~ NA_character_,
(searchword_sheinbaum == TRUE & lemmas == "sheinbaum") ~ NA_character_,
(searchword_gobierno_colectivos == TRUE & lemmas %in% c("gobierno", "colectivos")) ~ NA_character_,
(searchword_defensores_territorio == TRUE & lemmas %in% c("defensor", "territorio")) ~ NA_character_,
lemmas %in% lemmas_to_exclude ~ NA_character_,
TRUE ~ lemmas)) %>%
filter(!is.na(lemmas))
# MOST COMMON LEMMAS ====
lemmas_count <- lemmas_for_count %>%
group_by(lemmas) %>%
count() %>%
filter(n >= 20)
View(lemmas_count)
